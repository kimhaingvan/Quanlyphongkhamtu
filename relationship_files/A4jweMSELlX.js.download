if (self.CavalryLogger) { CavalryLogger.start_js(["0eV4o"]); }

__d("XIncomingCallDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/incoming/",{user_id:{type:"FBID",required:!0},call_id:{type:"Int"},dialog_type:{type:"String",defaultValue:"VIDEO"},__asyncDialog:{type:"Int"}})}),null);
__d("FBRTCIncomingCallDialog",["AsyncDialog","AsyncRequest","Dialog","EventEmitter","FBRTCConstants","FBRTCSoundController","XIncomingCallDialogController","clearTimeout","setTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=7e4;a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c){var d;d=a.call(this)||this;d.peerID=b;d.callID=c;d.$FBRTCIncomingCallDialog2=!1;d.$FBRTCIncomingCallDialog1=null;return d}c.getCallEndReasonForNewRequest=function(){return null};var d=c.prototype;d.showIncomingDialog=function(a){var c=b("Dialog").getCurrent();c&&c.hide();c=b("XIncomingCallDialogController").getURIBuilder().setFBID("user_id",this.peerID).setInt("call_id",this.callID).setString("dialog_type",a).getURI();this.$FBRTCIncomingCallDialog1=new(b("AsyncRequest"))(c);this.$FBRTCIncomingCallDialog2=a===b("FBRTCConstants").IncomingCallDialogTypes.VIDEO;b("AsyncDialog").send(this.$FBRTCIncomingCallDialog1,this.$FBRTCIncomingCallDialog3.bind(this))};d.$FBRTCIncomingCallDialog3=function(a){if(!this.$FBRTCIncomingCallDialog1){b("setTimeout")(function(){a.hide()},1);return}this.$FBRTCIncomingCallDialog1=null;this.view=a;a.subscribe("confirm",this.$FBRTCIncomingCallDialog4.bind(this));a.subscribe("cancel",this.$FBRTCIncomingCallDialog5.bind(this));b("FBRTCSoundController").playIncomingRingtone(this.callID,this.peerID,{loop:!0,isP2P:!0});this.timeout=b("setTimeoutAcrossTransitions")(this.$FBRTCIncomingCallDialog6.bind(this),g)};d.cancel=function(){this.$FBRTCIncomingCallDialog1&&(this.$FBRTCIncomingCallDialog1.abort(),this.$FBRTCIncomingCallDialog1=null),this.timeout&&b("clearTimeout")(this.timeout),this.view&&(this.view.hide(),this.view=null),b("FBRTCSoundController").stopIncomingRingtone()};d.isForPeer=function(a){return this.peerID===a};d.isForCall=function(a){return this.callID===a};d.isForPeerAndCall=function(a,b){return this.peerID===a&&this.callID===b};d.$FBRTCIncomingCallDialog4=function(){this.cancel(),this.emit("answerCall",this.callID,this.$FBRTCIncomingCallDialog2)};d.$FBRTCIncomingCallDialog5=function(){this.cancel(),this.emit("ignoreCall",!1)};d.$FBRTCIncomingCallDialog6=function(){this.cancel(),this.emit("timeout",!1)};return c}(b("EventEmitter"));e.exports=a}),null);
__d("XVideoCallMissedCallController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/missed_call/",{user_id:{type:"Int",required:!0},__asyncDialog:{type:"Int"}})}),null);
__d("XVideoCallMissedCallDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/dismiss_all_missed_call_dialog/",{})}),null);
__d("FBRTCMissedVideoCallHandler",["Arbiter","AsyncDialog","AsyncRequest","ChannelConstants","FBRTCCore","FBRTCLogger","FBRTCSupport","XVideoCallMissedCallController","XVideoCallMissedCallDialogController","gkx"],(function(a,b,c,d,e,f){var g=null,h=null,i=null;a=function(){function a(){this.$1=null}var c=a.prototype;c.hideDialog=function(){g&&(g.hide(),g=null,h=null,i&&(i.unsubscribe(),i=null))};c.onCallMissed=function(a){if(!b("FBRTCSupport").isWebrtcSupported())return;h===null&&(this.$1=a)};c.showDialog=function(a){a&&(this.$2=a);if(!this.$1||h)return;h=this.$1;this.$1=null;a=b("XVideoCallMissedCallController").getURIBuilder().setInt("user_id",h).getURI();a=new(b("AsyncRequest"))(a);b("AsyncDialog").send(a,this.$3.bind(this))};c.$3=function(a){g=a,a.subscribe("confirm",this.$4.bind(this)),a.subscribe("cancel",this.$5.bind(this)),i=b("Arbiter").subscribe(b("ChannelConstants").getArbiterType("dismiss_all_missed_call_dialog"),this.$6.bind(this))};c.$4=function(){h&&(b("gkx")("1105821")?this.$2!=null&&this.$2():b("FBRTCCore").startOutgoingCall(h,b("FBRTCLogger").Trigger.RETURN_CALL,!1)),this.$5()};c.$5=function(){this.hideDialog(),this.$7()};c.$7=function(){new(b("AsyncRequest"))(b("XVideoCallMissedCallDialogController").getURIBuilder().getURI()).send()};c.$6=function(){this.hideDialog()};return a}();e.exports=a}),null);
__d("XBrowserNotSupportedDialogController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/videocall/browser_not_supported/",{is_group_call:{type:"Bool",defaultValue:!1},participants:{type:"StringVector"},user_id:{type:"Int"},warning:{type:"Bool",defaultValue:!1},call_type:{type:"Enum",defaultValue:2,enumType:0},__asyncDialog:{type:"Int"}})}),null);
__d("FBRTCUnsupportedBrowserMessage",["requireCond","AsyncDialog","AsyncRequest","FBRTCCallConstants","FBRTCSoundController","MessengerDesktopUpsellLinks","MessengerDialogs.re","cr:1453546","React","XBrowserNotSupportedDialogController"],(function(a,b,c,d,e,f){var g=b("FBRTCCallConstants").FBRTCCallType,h=b("React");a={_dialog:null,warnForOutgoingCall:function(a){var c=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("warning",!0).getURI();this._presentDialog(c,a)},showForOutgoingCall:function(){var a=b("MessengerDesktopUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(a!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:a,hideDialog:b("MessengerDialogs.re").removeAllDialogs,isGroupCall:!1,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{var c=b("XBrowserNotSupportedDialogController").getURIBuilder().getURI();this._presentDialog(c)}},showForIncomingCall:function(a,c){b("FBRTCSoundController").playIncomingRingtone(a,c,{loop:!1,isP2P:!0,isUnsupportedDialog:!0});var d=b("MessengerDesktopUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(d!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:d,hideDialog:b("MessengerDialogs.re").removeAllDialogs,incomingUserID:c,isGroupCall:!1,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{a=b("XBrowserNotSupportedDialogController").getURIBuilder().setInt("user_id",c).getURI();this._presentDialog(a)}},showForIncomingGroupCall:function(a,c,d,e){b("FBRTCSoundController").playIncomingRingtone(a,e,{loop:!1,isP2P:!1,isUnsupportedDialog:!0});var f=b("MessengerDesktopUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(f!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:f,hideDialog:b("MessengerDialogs.re").removeAllDialogs,incomingUserID:d,isGroupCall:!0,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{a=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).setInt("user_id",d).setStringVector("participants",c).getURI();this._presentDialog(a)}},showForOutgoingGroupCall:function(){var a=b("MessengerDesktopUpsellLinks").getDesktopUpsellLinkIfEnabledForCalls();if(a!=null&&b("cr:1453546")!=null)b("MessengerDialogs.re").showDialog(function(){return h.jsx(b("cr:1453546"),{desktopAppstoreLink:a,hideDialog:b("MessengerDialogs.re").removeAllDialogs,isGroupCall:!0,onUnmount:function(a){a||b("MessengerDialogs.re").removeAllDialogs()}})});else{var c=b("XBrowserNotSupportedDialogController").getURIBuilder().setBool("is_group_call",!0).getURI();this._presentDialog(c)}},showForUnsupportedCollabCall:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_VIDEO_CALL).getURI();this._presentDialog(a)},showForUnsupportedCollabScreenSharing:function(){var a=b("XBrowserNotSupportedDialogController").getURIBuilder().setEnum("call_type",g.COLLAB_SCREEN_SHARE_CALL).getURI();this._presentDialog(a)},dismiss:function(){this._dialog&&this._dialog.hide()},_presentDialog:function(a,c){var d=this;if(this._dialog)return;a=new(b("AsyncRequest"))(a);b("AsyncDialog").send(a,function(a){d._dialog=a,a.subscribe("hide",function(){d._dialog=null,c&&c()})})}};e.exports=a}),null);
__d("StartCallWithZenonOrFBRTC",["requireCond","Bootloader","cr:1673157","cr:1673158","RTWebIncomingRingConfiguration","cr:1673159","cr:1673160"],(function(a,b,c,d,e,f){"use strict";a={startP2PCall:function(a,c,d,e,f){b("cr:1673159")!=null&&b("cr:1673158")!=null&&b("cr:1673160")!=null?b("cr:1673160").startCall(b("cr:1673159").get(),{existingCall:null,invitees:[c],mediaType:a?"audio":"video",thread:{id:d,type:b("cr:1673158").ONE_TO_ONE},trigger:e}):b("cr:1673157")!=null&&b("cr:1673157").startOutgoingCall(c,e,a,!1,f)},startGroupCall:function(a,c,d,e,f){f===void 0&&(f=null);if(b("cr:1673159")!=null&&b("cr:1673158")!=null&&b("cr:1673160")!=null){if(!b("RTWebIncomingRingConfiguration").isSupportedClientForProtocol("mw")){b("Bootloader").loadModules(["MessengerRTCUnsupportedBrowserDialogController"],function(b){b.render({hasVideo:!a,isGroupCall:!0})},"StartCallWithZenonOrFBRTC");return}b("cr:1673160").startCall(b("cr:1673159").get(),{existingCall:f,invitees:d,mediaType:a?"audio":"video",thread:{id:c,type:b("cr:1673158").GROUP},trigger:e})}else b("cr:1673157")!=null&&(f!=null&&f.server_info_data!=null?b("cr:1673157").startGroupCall({conferenceName:"GROUP:"+c,hasVideo:!a,serverInfoData:f.server_info_data,trigger:e}):d.length>0?b("cr:1673157").startGroupCall({conferenceName:"GROUP:"+c,hasVideo:!a,trigger:e,usersToRing:d}):b("cr:1673157").startGroupCall({conferenceName:"GROUP:"+c,hasVideo:!a,trigger:e}))}};e.exports=a}),null);
__d("MessengerRTCOutgoingP2PCallConfirmationDialog.react",["ix","fbt","Image.react","React","RTWebUserActionLogger","UFIImageBlock.react","XUIDialog.react","XUIDialogBody.react","XUIDialogButton.react","XUIDialogCancelButton.react","XUIDialogFooter.react","XUIDialogTitle.react","asset"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React"),j=50;function a(a){var c=a.isAudioCall,d=a.onClose,e=a.onStartCall,f=a.profilePicture,k=a.shortName;a=a.shown;i.useEffect(function(){b("RTWebUserActionLogger").logPreCallImpression({callType:"p2p",surface:"chat_sidebar_confirmation_dialog",mediaType:c?"audio":"video"})},[c]);var l="",m="",n="",o="";c?(l=h._("B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi tho\u1ea1i"),m=h._("B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi tho\u1ea1i v\u1edbi {caller name}?",[h._param("caller name",i.jsx("strong",{children:k}))]),n=i.jsx(b("Image.react"),{src:g("1369229")}),o=h._("B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi")):(l=h._("B\u1eaft \u0111\u1ea7u chat video"),m=h._("B\u1eaft \u0111\u1ea7u chat video v\u1edbi {callee name}?",[h._param("callee name",i.jsx("strong",{children:k}))]),n=i.jsx(b("Image.react"),{src:g("1427877")}),o=h._("B\u1eaft \u0111\u1ea7u chat video"));return i.jsxs(b("XUIDialog.react"),{layerHideOnBlur:!1,shown:a,width:445,children:[i.jsx(b("XUIDialogTitle.react"),{showCloseButton:!1,children:l}),i.jsx(b("XUIDialogBody.react"),{children:i.jsxs(b("UFIImageBlock.react"),{spacing:"medium",children:[i.jsx(b("Image.react"),{height:j,width:j,src:f}),m]})}),i.jsxs(b("XUIDialogFooter.react"),{children:[i.jsx(b("XUIDialogCancelButton.react"),{action:"cancel",onClick:function(a){a.preventDefault(),b("RTWebUserActionLogger").logPreCallClick({callType:"p2p",surface:"chat_sidebar_confirmation_dialog",mediaType:c?"audio":"video",component:"cancel_button"}),d()}}),i.jsx(b("XUIDialogButton.react"),{action:"confirm",image:n,label:o,onClick:function(a){a.preventDefault(),b("RTWebUserActionLogger").logPreCallClick({callType:"p2p",surface:"chat_sidebar_confirmation_dialog",mediaType:c?"audio":"video",component:"start_call_button"}),e(),d()},type:"primary",use:"confirm"})]})]})}}),null);
__d("ChatSidebarCallButtons.react",["ix","cx","fbt","CurrentUser","FBRTCSupport","FBRTCUnsupportedBrowserMessage","Image.react","ImmutableObject","MercuryIDs","MessengerParticipantsFetcher.bs","MessengerRTCGroupCallParticipantsPickerDialogController","MessengerRTCOutgoingP2PCallConfirmationDialog.react","MessengerState.re","React","RTWebUserActionLogger","ShimButton.react","StartCallWithZenonOrFBRTC","asset","gkx","immutable","nullthrows","qex"],(function(a,b,c,d,e,f,g,h,i){"use strict";e.exports=a;var j=b("React");function a(a){var c,d=a.onMouseLeave,e=a.hover,f=a.shortName,g=a.profilePicture,h=a.threadID;a=(a=b("qex")._("1442118"))!=null?a:!1;c=(c=b("qex")._("1442119"))!=null?c:!1;var i=j.useState(!1),l=i[0],n=i[1];i=j.useState(!1);var o=i[0],p=i[1];i=function(a){p(a),n(!0)};var q=null;l&&b("MercuryIDs").isCanonical(h)&&(q=j.jsx(b("MessengerRTCOutgoingP2PCallConfirmationDialog.react"),{shortName:f,profilePicture:g,onClose:function(){d(),n(!1)},onStartCall:function(){m(o,h)},isAudioCall:o,shown:l}));return j.jsxs(j.Fragment,{children:[e?j.jsxs(j.Fragment,{children:[c?j.jsx(k,{shortName:f,threadID:h,isAudioCall:!0,onShowConfirmationDialog:i}):null,a?j.jsx(k,{shortName:f,threadID:h,isAudioCall:!1,onShowConfirmationDialog:i}):null]}):null,q]})}function k(a){var c=a.isAudioCall,d=a.shortName,e=a.threadID,f=a.onShowConfirmationDialog;j.useEffect(function(){b("RTWebUserActionLogger").logPreCallImpression({callType:"p2p",surface:"chat_sidebar",component:c?"audio_button":"video_button"})},[c]);a=j.useState(!1);var h=a[0],k=a[1];a=c?j.jsx(b("Image.react"),{src:g("588631")}):j.jsx(b("Image.react"),{src:g("480009")});var m=c?j.jsx(b("Image.react"),{src:g("531568")}):j.jsx(b("Image.react"),{src:g("788092")});return j.jsx(b("ShimButton.react"),{"aria-label":d!=null?c?i._("B\u1eaft \u0111\u1ea7u cu\u1ed9c g\u1ecdi tho\u1ea1i v\u1edbi {shortname}",[i._param("shortname",d)]):i._("B\u1eaft \u0111\u1ea7u chat video v\u1edbi {shortname}",[i._param("shortname",d)]):null,"data-testID":c?"startVoiceCall":"startVideoCall",className:"_8_e2",onMouseEnter:function(){return k(!0)},onMouseLeave:function(){return k(!1)},onClick:function(a){a.preventDefault(),b("RTWebUserActionLogger").logPreCallClick({callType:"p2p",surface:"chat_sidebar",component:c?"audio_button":"video_button"}),l(c,e,f)},children:h?m:a})}function l(a,c,d){if(b("MercuryIDs").isCanonical(c))d?d(a):m(a,c);else{if(!b("FBRTCSupport").isGroupCallWebtrcSupported()){b("FBRTCUnsupportedBrowserMessage").showForOutgoingGroupCall();return}var e=b("MercuryIDs").getThreadFBIDFromThreadID(c),f=b("CurrentUser").getID(),g=a?"chat_sidebar_audio_button":"chat_sidebar_video_button";b("MessengerState.re").getThreadMeta(f,c,function(c){var d=c.participants?c.participants.filter(function(a){return a!==b("MercuryIDs").getParticipantIDFromUserID(f)}).map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)}).filter(Boolean):[];if(d.length>0){var h=b("qex")._("1006758")||0;if(d.length<h)b("StartCallWithZenonOrFBRTC").startGroupCall(!!a,e,d,g);else{var i=null;b("gkx")("1105821")&&(i=function(c){b("StartCallWithZenonOrFBRTC").startGroupCall(!!a,e,c,g)});b("MessengerParticipantsFetcher.bs").$$fetch({ids:d}).done(function(d){b("MessengerRTCGroupCallParticipantsPickerDialogController").render({participants:b("immutable").Map(d.map(function(a){return[a.id,new(b("ImmutableObject"))(a)]})),thread:c,viewerID:f,trigger:g,conferenceName:"GROUP:"+e,hasVideo:!a,handleCall:i})})}}else b("StartCallWithZenonOrFBRTC").startGroupCall(!!a,e,d,g)})}}function m(a,c){var d=b("nullthrows")(b("MercuryIDs").getUserIDFromThreadID(c));c=b("MercuryIDs").getThreadFBIDFromThreadID(c);var e=a?"chat_sidebar_audio_button":"chat_sidebar_video_button";b("StartCallWithZenonOrFBRTC").startP2PCall(a,d,c,e,!0)}}),null);